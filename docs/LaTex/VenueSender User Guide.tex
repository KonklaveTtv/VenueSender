\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{fontspec}
\usepackage{xcolor}
\usepackage{geometry}
\usepackage{listings}
\usepackage{mdframed}

\setmainfont{Arial}

\definecolor{background}{RGB}{40,40,40}
\definecolor{textcolor}{RGB}{230,230,230}
\definecolor{accent}{RGB}{90,90,255}
\pagecolor{background}
\color{textcolor}

\geometry{a4paper, margin=0.8in, top=1.2in, bottom=1.2in}

\lstdefinestyle{mystyle}{
	backgroundcolor=\color{background},
	commentstyle=\color{accent},
	keywordstyle=\color{textcolor},
	numberstyle=\tiny\color{textcolor},
	stringstyle=\color{accent},
	basicstyle=\ttfamily\footnotesize\color{textcolor},
	breakatwhitespace=false,
	breaklines=true,
	captionpos=b,
	keepspaces=true,
	numbers=left,
	numbersep=5pt,
	showspaces=false,
	showstringspaces=false,
	showtabs=false,
	tabsize=2
}
\lstset{style=mystyle}

% Hyperref for links
\usepackage[colorlinks=true, allcolors=accent]{hyperref}

% Header/Footer setup for dark theme
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\lhead{\color{textcolor}VenueSender Codebase Overview}
\rhead{\color{textcolor}\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}
\renewcommand{\headrule}{\hbox to\headwidth{\color{accent}\leaders\hrule height \headrulewidth\hfill}}
\renewcommand{\footrule}{\hbox to\headwidth{\color{accent}\leaders\hrule height \footrulewidth\hfill}}

% Other packages
\usepackage{enumitem}
\usepackage{microtype}

\title{\color{textcolor}User Guide for VenueSender}
\begin{document}
	
	\author{Created by Spencer Lievens}
	\date{\today}
	
	\maketitle
	
	\section*{Introduction}
	Welcome to the VenueSender user guide! This tool facilitates managing and sending emails to a list of venues, ensuring efficient and streamlined communications. This guide provides step-by-step instructions to navigate and utilize the program effectively.
	
	\section*{Starting the Program}
	Execute the VenueSender executable. Upon loading, the program initializes configurations and data. Should any setup issues emerge, descriptive error messages guide you through resolution.
	
	\section*{Configuration Files}
	The program relies on specific configuration files to operate correctly:
	\begin{itemize}
		\item \texttt{venues.csv}: Contains venue data. Ensure it is located in the root directory.
		\item \texttt{config.json}: Holds various configurations like SMTP settings and email details. It should also be in the root directory.
		\item For testing purposes, \texttt{mock\_venues.csv} and \texttt{mock\_config.json} should be located in the \texttt{src/test/} directory.
	\end{itemize}
	
	\section*{Venue Data Format}
	The \texttt{venues.csv} file should be structured with six columns: name, email, genre, state, city, and capacity. Ensure this format is maintained to prevent reading errors.
	
	\section*{Main Menu}
	After initiation, the main menu presents several options:
	\begin{itemize}
		\item Filter by Genre: Select venues based on genre.
		\item Filter by State: Choose venues from a particular state.
		\item Filter by City: Filter venues by city.
		\item Filter by Capacity: Opt for venues based on capacity.
		\item Clear Selected Venues: Reset your venue selections.
		\item Clear Booking Template: Clears the current email/template.
		\item View Selected Venues: Review your chosen venues.
		\item Show Email Settings: View email configurations.
		\item View \& Edit Email: Inspect and modify the current email draft.
		\item Venue Booking Template: Dispatch emails based upon a booking template.
		\item Email Custom Address: Dispatch an email to a custom address.
		\item Finish \& Send Emails: Dispatch emails to the selected venues.
		\item Exit VenueSender: Shut down the program.
	\end{itemize}
	
	\section*{Filtering Venues}
	VenueSender offers you the flexibility to tailor your audience by filtering venues based on various criteria.
	
	\subsection*{Filter by Genre}
	VenueSender can identify unique genres from the list of venues. To filter:
	\begin{itemize}
		\item Available Genres: The program displays a list of genres.
		\item Selection: Input comma-separated indices corresponding to desired genres.
	\end{itemize}
	
	\subsection*{Filter by State}
	Choose venues from specific states:
	\begin{itemize}
		\item Available States: A list of states is presented.
		\item Selection: Enter comma-separated indices of your preferred states.
	\end{itemize}
	
	\subsection*{Filter by City}
	\begin{itemize}
		\item Available Cities: A list of cities will be displayed.
		\item Selection: Specify comma-separated indices of cities you're targeting.
	\end{itemize}
	
	\subsection*{Filter by Capacity}
	For targeting venues based on seating:
	\begin{itemize}
		\item Available Capacities: VenueSender showcases various venue capacities.
		\item Selection: Indicate comma-separated indices that match the capacities you're interested in.
	\end{itemize}
	
	\section*{Reviewing and Resetting Selections}
	After filtering:
	\begin{itemize}
		\item View Selected Venues: Check the venues you've picked.
		\item Clear Selected Venues: Use this to reconsider or correct any mistaken selections.
	\end{itemize}
	
	\section*{Managing Your Email}
	\subsection*{Constructing the Email}
	Upon selecting View \& Edit Email:
	\begin{itemize}
		\item Subject: Enter the email subject. Remember, it shouldn't exceed a specified character limit. If it does, an error message will prompt you to shorten it.
		\item Message: Write the email content. Be wary of the character limit. If exceeded, you'll be alerted to condense your message.
		\item Attachment: Attach files by providing their paths. Ensure the attachment size doesn't surpass the limit (e.g., 24MB). If the file is too large, you'll be notified to pick a smaller file.
	\end{itemize}
	
	\subsection*{Email Password Encryption}
	For added security, the program encrypts the email password stored in the configuration file. If the password is not encrypted, the program will automatically encrypt it upon initialization. 
	
	\subsection*{Email Settings}
	Access Show Email Settings to review:
	\begin{itemize}
		\item SMTP Server
		\item SMTP Port
		\item Sender Email
		\item SSL Status
		\item verifyPeer Status
		\item verifyHost Status
		\item Verbose Mode
	\end{itemize}
	
	\subsection*{Booking Template Creation}
	VenueSender provides a unique feature that allows users to craft a templated email that can be sent to multiple venues. The template is constructed based on specific details provided by the user and then tailored to each selected venue.
	
	\begin{enumerate}
		\item Upon initiating the template creation, the program prompts the user for various details like genre, band name, hometown, similar artists, date, music and video links, press quote, user's name, and social links.
		\item The program then dynamically generates the email template using the provided details and formats it for each selected venue.
		\item Once the template is constructed, the user can review it. If desired, modifications can be made or the template can be sent directly to the selected venues.
	\end{enumerate}
	
	\subsubsection*{Sample Email Template}
	Here's a glimpse of how the constructed template might look:
	
	\begin{mdframed}[backgroundcolor=background, linecolor=accent]
		\begin{lstlisting}
			Hi! I am booking a tour for my [Genre] band called [Band Name] from [Hometown]. The music is in a similar vein as [Similar Artists]. We are planning to be in the [City] area on [Date] and are wondering if you might be interested in booking us at [Venue Name]?
			
			music: [Music Link]
			live video: [Live Performance Video Link]
			music video: [Music Video Link]
			
			press quote: [Press Quote]
			
			Let me know if you have any questions, thanks for your time and consideration!
			Best,
			[Your Name]
			
			social links:
			[Social Links]
		\end{lstlisting}
	\end{mdframed}
	
	Note: The values enclosed in square brackets (e.g., [Genre], [Band Name]) are placeholders and will be replaced with the actual details provided by the user.
	
	\subsubsection*{Post-Creation Steps}
	After creating the template:
	\begin{itemize}
		\item The user has the option to modify or send the template.
		\item If choosing to send, the program dispatches the email to each of the selected venues individually. The status for each email will be displayed.
		\item If the user decides not to send the template right away, it is saved and can be sent later.
	\end{itemize}
	
	\subsection*{Sending Emails}
	Finish \& Send Emails initiates the process:
	\begin{itemize}
		\item Before dispatching the emails, ensure that venues are selected. The program will remind you to do so if you haven't.
		\item The program checks the sender's email format. If it's incorrect, an error message instructs you to adjust it in your custom.json file.
		\item The program then checks if more than 49 venues have been selected. If so, it sends using "Bcc". If less than 49 venues are selected, then it sends an individual email to each.
		\item Connects to the SMTP server and authenticates.
		\item Emails are dispatched. For each, you'll receive a status update. Should any sending issues arise, you'll be informed (e.g., connection errors, authentication failures).
		\item Once all emails are sent, a completion message appears. Press return to continue.
	\end{itemize}
	
	\subsection*{Custom Address Email Sending}
	For emails addressed to a custom recipient:
	\begin{itemize}
		\item The user sets the custom email address to be used.
		\item The program checks the sender's email format. If it's incorrect, an error message instructs you to adjust it in your custom.json file.
		\item Connects to the SMTP server and authenticates.
		\item The email is dispatched and you receive a status update. Should any sending issues arise, you'll be informed (e.g., connection errors, authentication failures).
		\item Once the email is sent, a completion message appears. Press return to continue.
	\end{itemize}
	
	\section*{Exiting the Program}
	To leave:
	\begin{itemize}
		\item Exit VenueSender: Choose this from the main menu. A confirmation ensures your intent to close the program.
	\end{itemize}
	
	\section*{Troubleshooting \& Error Handling}
	VenueSender is engineered to offer informative error messages:
	\begin{itemize}
		\item If a problem arises, read the displayed message. It typically instructs on rectification steps.
		\item Restarting the program might help.
		\item For persistent issues, consult the FAQ or contact the support team.
	\end{itemize}
	
	\section*{Understanding Error Messages}
	VenueSender has built-in error handling to assist users in diagnosing problems. Here are some common errors and their solutions:
	\begin{itemize}
		\item \textbf{INVALID\_INPUT\_ERROR}: Invalid input. Skipping.
		\item \textbf{INVALID\_MENU\_INPUT\_ERROR}: Invalid input, please enter a number. Press return to retry.
		\item \textbf{INPUT\_LENGTH\_ERROR}: Input too long. Please try again.
		\item \textbf{INVALID\_CHOICE\_ERROR}: Invalid choice. Press return.
		\item \textbf{INVALID\_INDEX\_ERROR}: Invalid index for the given context.
		\item \textbf{INVALID\_INDEX\_FORMAT\_ERROR}: Invalid index format. Skipping.
		\item \textbf{NO\_VENUES\_SELECTED\_ERROR}: No venues selected yet.
		\item \textbf{VENUE\_ALREADY\_SELECTED\_ERROR}: Venue already selected. Skipping.
		\item \textbf{EMAIL\_AND\_SUBJECT\_BLANK\_ERROR}: Subject and Message are required. Please set them.
		\item \textbf{EMAIL\_AND\_SUBJECT\_WRITE\_ATTEMPTS\_ERROR}: Too many unsuccessful attempts.
		\item \textbf{NO\_VENUES\_SELECTED\_FOR\_EMAIL\_ERROR}: No venues selected. Please add venues before sending emails.
		\item \textbf{EMAIL\_ERROR}: An error occurred while processing the email.
		\item \textbf{SUBJECT\_LENGTH\_ERROR}: Subject cannot be longer than 50 characters in length.
		\item \textbf{EMAIL\_MESSAGE\_LENGTH\_ERROR}: Message cannot be longer than 2000 characters in length.
		\item \textbf{EMAIL\_BLANK\_ERROR}: Message cannot be blank.
		\item \textbf{SUBJECT\_MESSAGE\_ERROR}: An error occurred while entering subject and message.
		\item \textbf{EMAIL\_WRITING\_ATTEMPTS\_ERROR}: Too many unsuccessful attempts. Returning to main menu.
		\item \textbf{ATTACHMENT\_PATH\_ERROR}: File does not exist at the specified path.
		\item \textbf{ATTACHMENT\_SIZE\_ERROR}: File exceeds the 24MB limit.
		\item \textbf{SENDER\_EMAIL\_FORMAT\_ERROR}: The sender email format is not valid.
		\item \textbf{FILESYSTEM\_ERROR}: A filesystem error occurred.
		\item \textbf{CONFIG\_OPEN\_ERROR}: Failed to open the configuration file.
		\item \textbf{CONFIG\_LOAD\_ERROR}: Failed to load configuration settings.
		\item \textbf{CONFIG\_OPEN\_TO\_WRITE\_ERROR}: Failed to open the configuration file for writing.
		\item \textbf{INVALID\_CAPACITY\_IN\_CSV}: Invalid capacity value in the CSV file.
		\item \textbf{INVALID\_DATA\_IN\_CSV}: Incorrect data structure in the CSV file.
		\item \textbf{LIBSODIUM\_INIT\_ERROR}: Failed to initialize libsodium.
		\item \textbf{ENCRYPTION\_ERROR}: Failed to encrypt email password.
		\item \textbf{DECRYPTION\_ERROR}: Failed to decrypt passwords.
		\item \textbf{EMAIL\_PASSWORD\_ENCRYPTION\_ERROR}: Failed to encrypt email password.
		\item \textbf{EMAIL\_PASSWORD\_DECRYPTION\_ERROR}: Email password decryption failed.
		\item \textbf{EMAIL\_PASSWORD\_ENCRYPTION\_FORMAT\_ERROR}: Invalid encrypted password format.
		\item \textbf{LIBCURL\_ERROR}: Failed to initialize libcurl.
		\item \textbf{SMTP\_CONNECTION\_ERROR}: Connection to SMTP server failed.
		\item \textbf{SMTP\_AUTH\_ERROR}: Authentication with SMTP server failed.
		\item \textbf{UNKNOWN\_ERROR}: An unknown error occurred.
	\end{itemize}
	
	\section*{Conclusion}
	Thanks for choosing VenueSender! We hope this user guide aids in your software navigation. For further assistance or feedback, don't hesitate to reach out. Safe sending!
	
\end{document}
